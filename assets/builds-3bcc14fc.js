import{r as c,j as t,c as f,R as g}from"./index-81f15401.js";function $(e){const i=parseInt(e.substring(0,4),10),s=parseInt(e.substring(4,6),10)-1,r=parseInt(e.substring(6,8),10);return new Date(i,s,r).getDay()===1}function B(e,i=2){if(!+e)return"0 Bytes";const s=1024,r=i<0?0:i,a=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],o=Math.floor(Math.log(e)/Math.log(s));return`${parseFloat((e/s**o).toFixed(r))} ${a[o]}`}function k(e){const i=e.build,s=`https://build.protomaps.com/${i.key}`,r=i.key.substr(0,8),a=`https://build.protomaps.com/${r}.layerstats.parquet`,o=e.idx,d=()=>{e.setCmpA(o)},u=()=>{e.setCmpB(o)};return t.jsxs("tr",{style:{color:$(r)?"white":"#aaa"},children:[t.jsxs("td",{children:[t.jsx("span",{style:{display:"inline-block",width:"20px"},children:o>e.cmpB&&t.jsx("input",{type:"radio",onChange:d,checked:o===e.cmpA})}),t.jsx("span",{style:{display:"inline-block",width:"20px"},children:o<e.cmpA&&t.jsx("input",{type:"radio",onChange:u,checked:o===e.cmpB})})]}),t.jsx("td",{children:i.key}),t.jsx("td",{children:i.version}),t.jsx("td",{children:B(i.size)}),t.jsx("td",{children:i.uploaded}),t.jsx("td",{children:t.jsx("a",{href:`/#tiles=${s}`,children:"map"})}),t.jsx("td",{children:t.jsx("a",{href:`https://protomaps.github.io/PMTiles/?url=${s}`,children:"xray"})}),t.jsx("td",{children:t.jsx("a",{href:s,children:"download"})}),t.jsx("td",{children:r>="20231228"?t.jsx("a",{href:a,children:"stats"}):null})]})}function C(){const[e,i]=c.useState([]),[s,r]=c.useState(),[a,o]=c.useState(1),[d,u]=c.useState(0),h="light";c.useEffect(()=>{fetch("https://registry.npmjs.org/protomaps-themes-base",{headers:{Accept:"application/vnd.npm.install-v1+json"}}).then(n=>n.json()).then(n=>{const l=Object.keys(n.versions).filter(p=>+p.split(".")[0]>=2);r(l[l.length-1])})},[]);const y=()=>{const n=`https://build.protomaps.com/${e[a].key}`,l=`https://build.protomaps.com/${e[d].key}`;open(`/visualtests/?leftTiles=${n}&rightTiles=${l}`)},x=()=>{const n=e[a].key.replace(".pmtiles",""),l=e[d].key.replace(".pmtiles",""),p={name:`${n} ${s} ${h}`,type:"maplibre-gl",renderer:"maplibre-gl",index:0,url:`https://build-metadata.protomaps.dev/style@${s}+theme@${h}+tiles@${n}.json`},j={name:`${l} ${s} ${h}`,type:"maplibre-gl",renderer:"maplibre-gl",index:0,url:`https://build-metadata.protomaps.dev/style@${s}+theme@${h}+tiles@${l}.json`},b=JSON.stringify([p,j]);open(`https://stamen.github.io/maperture/#maps=${encodeURIComponent(b)}`)};return c.useEffect(()=>{fetch("https://build-metadata.protomaps.dev/builds.json").then(n=>n.json()).then(n=>{i(n.sort((l,p)=>l.key<p.key))})},[]),t.jsxs("div",{className:"builds",children:[t.jsx("h1",{children:"Builds"}),t.jsx("p",{children:"only Monday builds (white) are kept indefinitely."}),t.jsx("button",{type:"button",onClick:y,children:"Compare visual tests"}),s?t.jsxs("button",{type:"button",onClick:x,children:["Compare in Maperture (style ",s,")"]}):null,t.jsx("table",{children:t.jsx("tbody",{children:e.map((n,l)=>t.jsx(k,{build:n,idx:l,cmpA:a,cmpB:d,setCmpA:o,setCmpB:u},n.key))})})]})}const m=document.getElementById("root");m&&f.createRoot(m).render(t.jsx(g.StrictMode,{children:t.jsx(C,{})}));
